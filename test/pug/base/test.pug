html

	block vars
		- var title = 'test page'

	head
		title #{title}
		link(rel='stylesheet', type='text/css', href='/reset.css')
		style
			include:sass style.sass
		if (consoleMode === 'bottom')
			style
				include:sass console-bottom.sass
		block style


	body
		div.console
			pre
		div.stage
			block stage

		script.

			(function(){

				let consolePre = document.querySelector('div.console pre')

				let consoleLog = console.log

				console.log = function(...args) {

					consoleLog(...args)

					let span = document.createElement('span')
					span.innerHTML =  args.join(' ') + '\n'
					consolePre.append(span)

					if (consolePre.children.length > 120)
						consolePre.removeChild(consolePre.firstElementChild)

					consolePre.parentElement.scrollTop = consolePre.parentElement.scrollHeight

				}

			})()
				
			console.log('#{title}')

		if (scriptModule)
			script(type='module').
				import * as main from './#{scriptModule}'
				Object.assign(window, main)

		block script
